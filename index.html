<div id="streamsContainer" style="display:grid; grid-template-columns:repeat(auto-fit, minmax(300px,1fr)); gap:1em;"></div>

<script>
  const channelId = 'UCkiuIJAYRBXmuvqkjkDyrwg'; // your channel ID
  const apiKey = 'AIzaSyDnU9WvwaGZ79SbIF8pr9sfiSsw1lm6oqM'; // your API key

  async function fetchVideos(eventType = '') {
    const baseUrl = 'https://www.googleapis.com/youtube/v3/search';
    let url = `${baseUrl}?part=snippet&channelId=${channelId}&type=video&order=date&maxResults=20&key=${apiKey}`;
    if(eventType) {
      url += `&eventType=${eventType}`;
    }
    const response = await fetch(url);
    const data = await response.json();
    return data.items || [];
  }

  async function loadStreams() {
    const container = document.getElementById('streamsContainer');
    container.innerHTML = '';

    // Fetch current live streams
    const liveVideos = await fetchVideos('live');

    // Fetch recent videos and filter for completed live streams
    const recentVideos = await fetchVideos();
    const pastLiveVideos = recentVideos.filter(video => video.snippet.liveBroadcastContent === 'completed');

    // Combine live and past live videos (live first)
    const allStreams = [...liveVideos, ...pastLiveVideos];

    if(allStreams.length === 0) {
      container.innerHTML = '<p style="color:white;">No live or past live streams available.</p>';
      return;
    }

    // Generate iframe embeds
    allStreams.forEach(video => {
      const videoId = video.id.videoId;
      const title = video.snippet.title;
      const iframe = document.createElement('iframe');
      iframe.width = "100%";
      iframe.height = "200";
      iframe.src = `https://www.youtube.com/embed/${videoId}`;
      iframe.frameBorder = "0";
      iframe.allowFullscreen = true;
      iframe.style.borderRadius = '8px';

      const div = document.createElement('div');
      const titleEl = document.createElement('h3');
      titleEl.textContent = title;
      titleEl.style.color = 'white';
      titleEl.style.fontSize = '1rem';
      titleEl.style.marginBottom = '0.5rem';

      div.appendChild(titleEl);
      div.appendChild(iframe);
      container.appendChild(div);
    });
  }

  loadStreams();

  // Optionally refresh every 10 minutes
  setInterval(loadStreams, 10 * 60 * 1000);
</script>
